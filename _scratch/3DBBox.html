<html>
<script>

// https://github.com/mattdesl/ray-plane-intersection/
// https://www.cs.uaf.edu/2012/spring/cs481/section/0/lecture/01_26_ray_intersections.html

var CAM_X = 400;
var CAM_Y = 600;
var CAM_Z = 500;
var x = 800;
var y = 0;

var origin = [CAM_X, CAM_Y, CAM_Z];
var point  = [x, y, 0];

var direction = Vector3.direction(origin, point);

// TODO
//var at = transform(a);
//var bt = transform(b);
//var ct = transform(c);

var at = [0,   0,   -500];
var bt = [800, 0,   -500];
var ct = [800, 600, -500];
var dt = [0,   600, -500];

var normal = Plane.normal(at, bt, ct);
var distance = Plane.distance(normal, dt);
var hit = Plane.intersection(origin, direction, normal, distance);

console.log(hit)


/**
In a uniform transparent medium, light travels in straight lines.

Straight lines have a very simple equation:
(1) position_along_line = point_on_line + some_float * line_direction;
or  P = C + t * D;
This is called a parametric equation, because "some_float" is a free parameter.  Raytracing is a way to draw arbitrary objects by solving for this floating-point parameter.
Ray-Plane Intersection

For example, consider a plane.  If we specify the plane using a surface normal vector "plane_normal", the distance along this normal from the plane to the origin, then points on a plane satisfy this equation:
(2) dot(point_in_plane,plane_normal) = distance_to_origin
or  dot(P,N) = k
(Rationale: moving in the plane is motion perpendicular to the normal.  The dot product of perpendicular vectors is zero.)

If we want to find when the plane and line intersect, we just set:
  point_in_plane = position_along_line
This lets us substitute equation (1) into equation (2), giving:
  dot(point_on_line + some_float * line_direction,plane_normal) = distance_to_origin
or  dot(C+t*D,N) = k
which we have to solve for "some_float" (t).  It's not immediately clear how to do this, because t is trapped inside the dot product.  But linearity to the rescue!  It turns out that dot product distributes over vector addition and scalar multiplication, so
  dot(C+t*D,N) = dot(C,N) + t*dot(D,N) = k
This is now just a linear equation in t, with solution:
  t=(k-dot(C,N))/dot(D,N)
We can then plug this parameter t back into the ray equation (1) to get the ray/line intersection point.

Note that if dot(D,N)==0, then the ray is parallel to the plane, and there is no solution for t.  Also, depending on the orientation of the camera and plane, the camera ray may hit the plane behind the viewer, at negative t values.  So in practice, you compute t as above, then check to see if it's a reasonable intersection.  If so, we draw the object.

To actually draw the object, we also need a surface normal.  This is really easy for a plane, because a plane only has one fixed value for its surface normal, and we've already had to specify it just to define the plane!
**/

    </script>
</html>